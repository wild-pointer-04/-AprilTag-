# ç›¸æœºæ‹ç…§æœåŠ¡ - å¿«é€Ÿä½¿ç”¨æŒ‡å—

## ğŸ“¦ åŒ…å†…å®¹

æœ¬å‹ç¼©åŒ…åŒ…å«å®Œæ•´çš„ç›¸æœºæ‹ç…§æœåŠ¡ç¨‹åºï¼Œå¯ç›´æ¥åœ¨ ROS2 ç¯å¢ƒä¸‹ä½¿ç”¨ã€‚

```
camera_capture_package/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ camera_capture_service_node.py    # æ‹ç…§æœåŠ¡æ ¸å¿ƒç¨‹åº
â”œâ”€â”€ launch/
â”‚   â””â”€â”€ camera_capture_service.launch.py  # ROS2 å¯åŠ¨æ–‡ä»¶
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ camera_capture_service_usage.md   # è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ captured_images/                       # ç¤ºä¾‹æ‹ç…§å›¾ç‰‡
â”‚   â”œâ”€â”€ capture_0001_*.png
â”‚   â”œâ”€â”€ capture_0002_*.png
â”‚   â””â”€â”€ capture_0003_*.png
â”œâ”€â”€ start_camera_capture_service.sh        # å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
â”œâ”€â”€ test_camera_capture_service.py         # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ README_CAMERA_CAPTURE_SERVICE.md       # å¿«é€ŸæŒ‡å—
â””â”€â”€ å¿«é€Ÿä½¿ç”¨æŒ‡å—.md                         # æœ¬æ–‡ä»¶
```

## ğŸš€ ä¸‰æ­¥å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ç›¸æœº

```bash
source ~/ros2_ws/install/setup.bash
ros2 launch orbbec_camera gemini_330_series.launch.py
```

### ç¬¬äºŒæ­¥ï¼šå¯åŠ¨æ‹ç…§æœåŠ¡

**æ¨èæ–¹å¼ï¼ˆæœ€ç®€å•ï¼‰ï¼š**
```bash
cd camera_capture_package
./start_camera_capture_service.sh
```

ç„¶åé€‰æ‹©é€‰é¡¹ 1ï¼ˆå¯åŠ¨æ‹ç…§æœåŠ¡-é»˜è®¤å‚æ•°ï¼‰

**æˆ–è€…ç›´æ¥è¿è¡Œï¼š**
```bash
python3 src/camera_capture_service_node.py
```

### ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•æ‹ç…§

**æ–¹å¼ä¸€ï¼šä½¿ç”¨æµ‹è¯•è„šæœ¬**
```bash
python3 test_camera_capture_service.py --single
```

**æ–¹å¼äºŒï¼šä½¿ç”¨ ROS2 å‘½ä»¤**
```bash
ros2 service call /camera_capture std_srvs/srv/Trigger
```

## ğŸ¤– ä¸æœºæ¢°è‡‚é›†æˆ

æœºæ¢°è‡‚åˆ°è¾¾æŒ‡å®šä½ç½®åï¼Œè°ƒç”¨æ‹ç…§æœåŠ¡ï¼š

```python
import rclpy
from std_srvs.srv import Trigger

# åˆå§‹åŒ–
rclpy.init()
node = rclpy.create_node('robot_arm_client')
client = node.create_client(Trigger, '/camera_capture')
client.wait_for_service()

# æ‹ç…§
request = Trigger.Request()
future = client.call_async(request)
rclpy.spin_until_future_complete(node, future)

response = future.result()
if response.success:
    print(f'æ‹ç…§æˆåŠŸ: {response.message}')  # è¾“å‡ºï¼šå·²æ‹å¥½ç¬¬1å¼ ç…§ç‰‡
```

## ğŸ“¸ æ‹ç…§ç»“æœ

æ‹æ‘„çš„å›¾åƒè‡ªåŠ¨ä¿å­˜åœ¨ `captured_images/` ç›®å½•ï¼š
```
captured_images/
â”œâ”€â”€ capture_0001_20231121_143025_123.png
â”œâ”€â”€ capture_0002_20231121_143030_456.png
â””â”€â”€ capture_0003_20231121_143035_789.png
```

æ–‡ä»¶åæ ¼å¼ï¼š`capture_åºå·_æ—¥æœŸ_æ—¶é—´_æ¯«ç§’.png`

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡æ˜¯å¦è¿è¡Œ
ros2 service list | grep capture

# æŸ¥çœ‹æœåŠ¡ç±»å‹
ros2 service type /camera_capture

# æŸ¥çœ‹å¯ç”¨çš„å›¾åƒè¯é¢˜
ros2 topic list | grep image

# å•æ¬¡æ‹ç…§æµ‹è¯•
python3 test_camera_capture_service.py --single

# å¤šæ¬¡æ‹ç…§æµ‹è¯•ï¼ˆæ¨¡æ‹Ÿæœºæ¢°è‡‚å·¥ä½œæµç¨‹ï¼‰
python3 test_camera_capture_service.py --count 5 --interval 2.0
```

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

å¦‚æœéœ€è¦ä¿®æ”¹é»˜è®¤å‚æ•°ï¼š

```bash
python3 src/camera_capture_service_node.py \
    --image-topic /camera/color/image_raw \
    --service-name /camera_capture \
    --output-dir captured_images \
    --save-format png
```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- **å¿«é€ŸæŒ‡å—**ï¼š`README_CAMERA_CAPTURE_SERVICE.md`
- **è¯¦ç»†æ–‡æ¡£**ï¼š`docs/camera_capture_service_usage.md`

## â“ å¸¸è§é—®é¢˜

### 1. æœåŠ¡æœªæ‰¾åˆ°
```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
ros2 service list | grep capture
```

### 2. ç›¸æœºæœªè¿æ¥
```bash
# æ£€æŸ¥ç›¸æœºè¯é¢˜
ros2 topic list | grep camera
```

### 3. å›¾åƒè¯é¢˜é”™è¯¯
```bash
# æŸ¥çœ‹å¯ç”¨è¯é¢˜
ros2 topic list | grep image

# ä½¿ç”¨æ­£ç¡®çš„è¯é¢˜å¯åŠ¨
python3 src/camera_capture_service_node.py --image-topic /your/topic
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. âœ… ROS2 ç¯å¢ƒæ˜¯å¦æ­£ç¡®è®¾ç½®ï¼ˆ`echo $ROS_DISTRO`ï¼‰
2. âœ… ç›¸æœºæ˜¯å¦æ­£å¸¸è¿æ¥å¹¶å‘å¸ƒå›¾åƒè¯é¢˜
3. âœ… æ‹ç…§æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨
4. âœ… å›¾åƒè¯é¢˜åç§°æ˜¯å¦æ­£ç¡®

---

**ç‰ˆæœ¬**ï¼š1.0.0  
**æ›´æ–°æ—¥æœŸ**ï¼š2024å¹´11æœˆ
